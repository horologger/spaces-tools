#! /bin/bash

echo "Scanning for transactions associated with this wallet..."

while [ $(space-cli --output-format=json getwalletinfo | jq '.tip') -lt $(space-cli --output-format=json getserverinfo | jq '.tip.height') ]; do 
  TIP=$(space-cli --output-format=json getwalletinfo | jq '.tip')
  HEIGHT=$(space-cli --output-format=json getserverinfo | jq '.tip.height')
  PERC=$(bc -l <<<"(${TIP}-${GEN})/(${HEIGHT}-${GEN})*100")
  printf "\rBlock %s of %s %.2f%% done." "$TIP" "$HEIGHT" "$PERC"
  sleep 5
done
echo ""
echo "Finished Scanning"